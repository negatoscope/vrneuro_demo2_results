[{"name":"app.R","content":"library(shiny)\r\nlibrary(googlesheets4)\r\nlibrary(dplyr)\r\nlibrary(ggplot2)\r\nlibrary(reshape2)\r\nlibrary(ez)\r\nlibrary(DT) \r\n\r\nui <- fluidPage(\r\n  titlePanel(\"Empathy Experiment Results\"),\r\n  mainPanel(\r\n    plotOutput(\"totalPlot\"),\r\n    verbatimTextOutput(\"anova_Total\"),\r\n    plotOutput(\"conditionPlot\"), # Add this line\r\n    verbatimTextOutput(\"anova_EC\"),  # Add this line\r\n    verbatimTextOutput(\"anova_F\"),  # Add this line\r\n    verbatimTextOutput(\"anova_PD\"),  # Add this line\r\n    verbatimTextOutput(\"anova_PT\"),\r\n    DT::dataTableOutput(\"data\") \r\n  )\r\n)\r\n\r\nserver <- function(input, output) {\r\n  data <- reactive({\r\n    df <- read_sheet(\"https://docs.google.com/spreadsheets/d/1zm3Sv6F_4fEciHjSu1N8vMAeDL9k6olo6irfgXHrJB0\")\r\n    names(df) <- c(\"Time\", \"Code\", \"Condition\", paste0(\"Item\", 1:16))\r\n    df$EC <- rowSums(df[,c(\"Item1\", \"Item5\", \"Item9\", \"Item10\")])\r\n    df$F <- rowSums(df[,c(\"Item2\", \"Item7\", \"Item11\", \"Item14\")])\r\n    df$PD <- rowSums(df[,c(\"Item3\", \"Item8\", \"Item12\", \"Item15\")])\r\n    df$PT <- rowSums(df[,c(\"Item4\", \"Item6\", \"Item13\", \"Item16\")])\r\n    df$Total <- rowSums(df[,c(\"EC\", \"F\", \"PD\", \"PT\")])\r\n    df$Condition <- factor(df$Condition, levels = c(\"Before any test\", \"After video\", \"After VR experience\"))  # Add this line\r\n    df\r\n  })\r\n  \r\n  output$conditionPlot <- renderPlot({\r\n    df <- data()\r\n    df_melt <- reshape2::melt(df, id.vars = \"Condition\", measure.vars = c(\"EC\", \"F\", \"PD\", \"PT\"))\r\n    ggplot(df_melt, aes(x = variable, y = value, fill = Condition)) +\r\n      geom_bar(stat = \"summary\", fun = \"mean\", position = \"dodge\") +\r\n      labs(title = \"Sub-score Results\", x = \"Variable\", y = \"Mean Value\", fill = \"Condition\") +\r\n      theme_minimal()\r\n  })\r\n  \r\n  output$totalPlot <- renderPlot({\r\n    df <- data()\r\n    ggplot(df, aes(x = Condition, y = Total)) +\r\n      geom_bar(stat = \"summary\", fun = \"mean\", position = \"dodge\") +\r\n      labs(title = \"Total Scores Results\", x = \"Condition\", y = \"Mean Total Value\") +\r\n      theme_minimal()\r\n  })\r\n  \r\n  output$data <- DT::renderDataTable({  # Modify this block\r\n    df <- data()\r\n    DT::datatable(df, options = list(pageLength = 25))\r\n  })\r\n  \r\n  # Add these blocks\r\n  output$anova_Total <- renderPrint({\r\n    df <- data()\r\n    aov_results <- ezANOVA(\r\n      data = df,\r\n      dv = .(Total),\r\n      wid = .(Code),\r\n      within = .(Condition),\r\n      detailed = TRUE,\r\n      type = 3\r\n    )\r\n    if (aov_results$ANOVA[2, \"p\"] < 0.05) {\r\n      print(\"The effect of Condition on Total is statistically significant.\")\r\n    } else {\r\n      print(\"The effect of Condition on Total is not statistically significant.\")\r\n    }\r\n  })\r\n  \r\n  output$anova_EC <- renderPrint({\r\n    df <- data()\r\n    aov_results <- ezANOVA(\r\n      data = df,\r\n      dv = .(EC),\r\n      wid = .(Code),\r\n      within = .(Condition),\r\n      detailed = TRUE,\r\n      type = 3\r\n    )\r\n    if (aov_results$ANOVA[2, \"p\"] < 0.05) {\r\n      print(\"The effect of Condition on EC is statistically significant.\")\r\n    } else {\r\n      print(\"The effect of Condition on EC is not statistically significant.\")\r\n    }\r\n  })\r\n  \r\n  output$anova_F <- renderPrint({\r\n    df <- data()\r\n    aov_results <- ezANOVA(\r\n      data = df,\r\n      dv = .(F),\r\n      wid = .(Code),\r\n      within = .(Condition),\r\n      detailed = TRUE,\r\n      type = 3\r\n    )\r\n    if (aov_results$ANOVA[2, \"p\"] < 0.05) {\r\n      print(\"The effect of Condition on F is statistically significant.\")\r\n    } else {\r\n      print(\"The effect of Condition on F is not statistically significant.\")\r\n    }\r\n  })\r\n  \r\n  output$anova_PD <- renderPrint({\r\n    df <- data()\r\n    aov_results <- ezANOVA(\r\n      data = df,\r\n      dv = .(PD),\r\n      wid = .(Code),\r\n      within = .(Condition),\r\n      detailed = TRUE,\r\n      type = 3\r\n    )\r\n    if (aov_results$ANOVA[2, \"p\"] < 0.05) {\r\n      print(\"The effect of Condition on PD is statistically significant.\")\r\n    } else {\r\n      print(\"The effect of Condition on PD is not statistically significant.\")\r\n    }\r\n  })\r\n  \r\n  output$anova_PT <- renderPrint({\r\n    df <- data()\r\n    aov_results <- ezANOVA(\r\n      data = df,\r\n      dv = .(PT),\r\n      wid = .(Code),\r\n      within = .(Condition),\r\n      detailed = TRUE,\r\n      type = 3\r\n    )\r\n    if (aov_results$ANOVA[2, \"p\"] < 0.05) {\r\n      print(\"The effect of Condition on PT is statistically significant.\")\r\n    } else {\r\n      print(\"The effect of Condition on PT is not statistically significant.\")\r\n    }\r\n  })\r\n  \r\n}\r\n\r\nshinyApp(ui = ui, server = server)","type":"text"}]
